<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RAILS &mdash; Training Dynamics</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom"></script>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
        font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        background: #0f172a;
        color: #e2e8f0;
        line-height: 1.6;
        padding: 2rem 1rem;
    }
    .container { max-width: 1200px; margin: 0 auto; }

    h1 {
        font-size: 2rem; font-weight: 700;
        background: linear-gradient(135deg, #60a5fa, #a78bfa, #f472b6);
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.4rem;
    }
    .subtitle { color: #94a3b8; font-size: 0.95rem; }
    .pipeline-tag {
        display: inline-block; margin-top: 0.8rem;
        padding: 0.3rem 0.8rem; border-radius: 20px;
        font-size: 0.75rem; font-weight: 600;
        background: rgba(99, 102, 241, 0.15); color: #818cf8;
        border: 1px solid rgba(99, 102, 241, 0.3);
    }

    h2.section-title {
        font-size: 1.15rem; color: #f1f5f9; margin-bottom: 1rem;
        display: flex; align-items: center; gap: 0.6rem;
    }
    .section-num {
        display: inline-flex; align-items: center; justify-content: center;
        width: 28px; height: 28px; border-radius: 8px;
        background: rgba(99, 102, 241, 0.2); color: #818cf8;
        font-size: 0.8rem; font-weight: 700;
    }
    .section { margin-bottom: 2.5rem; }

    .card {
        background: #1e293b; border-radius: 16px; padding: 1.5rem;
        border: 1px solid #334155; margin-bottom: 1.2rem;
        transition: border-color 0.2s;
    }
    .card:hover { border-color: #475569; }
    .card h3 { font-size: 1rem; color: #f1f5f9; margin-bottom: 0.3rem; font-weight: 600; }
    .card p.note { font-size: 0.82rem; color: #94a3b8; margin-bottom: 1rem; line-height: 1.5; }

    .chart-container { position: relative; width: 100%; }

    .model-selector { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-bottom: 1rem; }
    .model-btn {
        padding: 0.35rem 0.8rem; border-radius: 8px;
        border: 1.5px solid #334155; background: transparent;
        color: #94a3b8; font-size: 0.8rem; font-weight: 500;
        cursor: pointer; transition: all 0.15s;
        font-family: 'Segoe UI', system-ui, sans-serif;
    }
    .model-btn:hover { border-color: #64748b; color: #e2e8f0; background: rgba(255,255,255,0.03); }
    .model-btn.active { border-color: #6366f1; background: rgba(99, 102, 241, 0.12); color: #a5b4fc; font-weight: 600; }

    .chart-grid-2x2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    @media (max-width: 768px) { .chart-grid-2x2 { grid-template-columns: 1fr; } }
    .mini-card {
        background: #1e293b; border-radius: 12px; padding: 1.2rem;
        border: 1px solid #334155;
    }
    .mini-card h4 { font-size: 0.88rem; color: #cbd5e1; margin-bottom: 0.6rem; font-weight: 600; }

    .stat-strip {
        display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 0.8rem; margin-bottom: 2rem;
    }
    .stat-box {
        background: #1e293b; border-radius: 12px; padding: 1rem;
        border: 1px solid #334155; text-align: center;
    }
    .stat-box .val {
        font-size: 1.6rem; font-weight: 700;
        background: linear-gradient(135deg, #60a5fa, #a78bfa);
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    .stat-box .lbl { font-size: 0.72rem; color: #64748b; margin-top: 0.2rem; text-transform: uppercase; letter-spacing: 0.05em; }

    .insight-grid {
        display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1rem;
    }
    .insight {
        background: #1e293b; border-radius: 12px; padding: 1.2rem;
        border: 1px solid #334155; border-left: 4px solid #6366f1;
    }
    .insight h4 { font-size: 0.88rem; color: #f1f5f9; margin-bottom: 0.4rem; }
    .insight p { font-size: 0.8rem; color: #94a3b8; line-height: 1.5; }
    .insight.green { border-left-color: #22c55e; }
    .insight.amber { border-left-color: #f59e0b; }
    .insight.rose { border-left-color: #f43f5e; }

    .zoom-hint {
        font-size: 0.72rem; color: #475569; text-align: right;
        margin-top: 0.4rem; font-style: italic;
    }
    .footer {
        text-align: center; color: #475569; font-size: 0.78rem;
        margin-top: 2.5rem; padding-top: 1rem; border-top: 1px solid #1e293b;
    }
</style>
</head>
<body>
<div class="container">

<div style="margin-bottom:2.5rem;">
    <h1>RAILS &mdash; Training Dynamics</h1>
    <p class="subtitle">Learning curves for SFT warmup and GRPO reinforcement learning with SAT-verified reasoning</p>
    <span class="pipeline-tag">SFT &rarr; GRPO (SAT-Think-from-SFT) &middot; 4 models &middot; live runs</span>
</div>

<div class="stat-strip">
    <div class="stat-box"><div class="val">4</div><div class="lbl">Models</div></div>
    <div class="stat-box"><div class="val">6,033</div><div class="lbl">SFT Examples</div></div>
    <div class="stat-box"><div class="val">SAT</div><div class="lbl">Consistency Reward</div></div>
    <div class="stat-box"><div class="val">2,660</div><div class="lbl">Max GRPO Steps</div></div>
</div>

<!-- SECTION 1: SFT -->
<div class="section">
    <h2 class="section-title"><span class="section-num">1</span> SFT Warmup</h2>
    <div class="card">
        <h3>Loss Convergence</h3>
        <p class="note">Supervised fine-tuning on 6,033 verified &lt;think&gt;+&lt;step&gt; completions (propositional + FOL + non-monotonic). All models converge rapidly. DeepSeek-14B starts from the lowest initial loss (0.62).</p>
        <div class="chart-container" style="height:340px;"><canvas id="sftChart"></canvas></div>
        <div class="zoom-hint">scroll to zoom &middot; drag to pan &middot; double-click to reset</div>
    </div>
</div>

<!-- SECTION 2: GRPO -->
<div class="section">
    <h2 class="section-title"><span class="section-num">2</span> GRPO Reward Dynamics</h2>

    <div class="card">
        <h3>Total Reward</h3>
        <p class="note">Combined reward (consistency + gated answer + format + length penalty). All models start from their SFT checkpoint. Qwen3-8B is the furthest along (2,660 steps).</p>
        <div class="chart-container" style="height:380px;"><canvas id="totalRewardChart"></canvas></div>
        <div class="zoom-hint">scroll to zoom &middot; drag to pan &middot; double-click to reset</div>
    </div>

    <div class="card">
        <h3>Reward Components</h3>
        <p class="note">Individual reward signals over training. Select a model to inspect.</p>
        <div class="model-selector" id="componentSelector">
            <button class="model-btn active" data-run="Qwen3-8B" onclick="switchComponents(this)">Qwen3-8B</button>
            <button class="model-btn" data-run="DeepSeek-7B" onclick="switchComponents(this)">DeepSeek-7B</button>
            <button class="model-btn" data-run="DeepSeek-14B" onclick="switchComponents(this)">DeepSeek-14B</button>
            <button class="model-btn" data-run="QwQ-32B" onclick="switchComponents(this)">QwQ-32B</button>
        </div>
        <div class="chart-grid-2x2">
            <div class="mini-card"><h4>Consistency</h4><div class="chart-container" style="height:220px;"><canvas id="compConsistencyChart"></canvas></div></div>
            <div class="mini-card"><h4>Answer (Gated)</h4><div class="chart-container" style="height:220px;"><canvas id="compAnswerChart"></canvas></div></div>
            <div class="mini-card"><h4>Format</h4><div class="chart-container" style="height:220px;"><canvas id="compFormatChart"></canvas></div></div>
            <div class="mini-card"><h4>Length Penalty</h4><div class="chart-container" style="height:220px;"><canvas id="compLengthChart"></canvas></div></div>
        </div>
    </div>

    <div class="card">
        <h3>KL Divergence</h3>
        <p class="note">Distance from the reference (SFT) policy. Qwen3-8B maintains rock-stable KL (~0.45). DeepSeek-7B shows a mid-training instability around step 450&ndash;650. DeepSeek-14B has early warmup spikes. Values capped at 100 for visualization.</p>
        <div class="chart-container" style="height:340px;"><canvas id="klChart"></canvas></div>
        <div class="zoom-hint">scroll to zoom &middot; drag to pan &middot; double-click to reset</div>
    </div>
</div>

<!-- SECTION 3: QUALITY -->
<div class="section">
    <h2 class="section-title"><span class="section-num">3</span> Training Quality</h2>
    <div class="card">
        <p class="note">Structural metrics tracked during GRPO. Select a model to inspect.</p>
        <div class="model-selector" id="qualitySelector">
            <button class="model-btn active" data-run="Qwen3-8B" onclick="switchQuality(this)">Qwen3-8B</button>
            <button class="model-btn" data-run="DeepSeek-7B" onclick="switchQuality(this)">DeepSeek-7B</button>
            <button class="model-btn" data-run="DeepSeek-14B" onclick="switchQuality(this)">DeepSeek-14B</button>
            <button class="model-btn" data-run="QwQ-32B" onclick="switchQuality(this)">QwQ-32B</button>
        </div>
        <div class="chart-grid-2x2">
            <div class="mini-card"><h4>Format Compliance</h4><div class="chart-container" style="height:220px;"><canvas id="qualFormatChart"></canvas></div></div>
            <div class="mini-card"><h4>Avg Valid Steps</h4><div class="chart-container" style="height:220px;"><canvas id="qualValidChart"></canvas></div></div>
            <div class="mini-card"><h4>Avg Num Steps</h4><div class="chart-container" style="height:220px;"><canvas id="qualNumStepsChart"></canvas></div></div>
            <div class="mini-card"><h4>Completion Length (tokens)</h4><div class="chart-container" style="height:220px;"><canvas id="qualLengthChart"></canvas></div></div>
        </div>
    </div>
</div>

<!-- SECTION 4: INSIGHTS -->
<div class="section">
    <h2 class="section-title"><span class="section-num">4</span> Key Observations</h2>
    <div class="insight-grid">
        <div class="insight green">
            <h4>Qwen3-8B: strongest learner</h4>
            <p>Reaches total reward ~2.3 by step 2,400 with rock-stable KL (~0.45). Consistency climbs steadily from 0.2 to 0.65, and format compliance holds above 0.6 throughout training.</p>
        </div>
        <div class="insight">
            <h4>DeepSeek-7B: mid-training instability</h4>
            <p>KL spikes at step 20 (warmup) and again around step 450&ndash;650 (KL 15&ndash;50). Reward drops to &minus;0.6 during the instability window but recovers to ~1.5 by step 900.</p>
        </div>
        <div class="insight amber">
            <h4>QwQ-32B: slow but promising</h4>
            <p>Starts with near-zero format compliance but rapidly learns it. By step 150, format reaches 0.70 and total reward turns positive. Only 150 steps so far&mdash;still very early.</p>
        </div>
        <div class="insight rose">
            <h4>DeepSeek-14B: early instability</h4>
            <p>Large KL spikes in the first 50 steps (up to 5,231) with loss reaching 104. Likely learning rate sensitivity. Stabilizes after step 60 but reward remains negative through step 200.</p>
        </div>
    </div>
</div>

<div class="footer">Updated February 20, 2026 &mdash; RAILS &mdash; ProofContinuity</div>
</div>

<script>
// === DATA ===
const D = {"grpo":{"DeepSeek-7B":{"step":[10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.0,110.0,120.0,130.0,140.0,150.0,160.0,170.0,180.0,190.0,200.0,210.0,220.0,230.0,240.0,250.0,260.0,270.0,280.0,290.0,300.0,310.0,320.0,330.0,340.0,350.0,360.0,370.0,380.0,390.0,400.0,410.0,420.0,430.0,440.0,450.0,460.0,470.0,480.0,490.0,500.0,510.0,520.0,530.0,540.0,550.0,560.0,570.0,580.0,590.0,600.0,610.0,620.0,630.0,640.0,650.0,660.0,670.0,680.0,690.0,700.0,710.0,720.0,730.0,740.0,750.0,760.0,770.0,780.0,790.0,800.0,810.0,820.0,830.0,840.0,850.0,860.0,870.0,880.0,890.0,900.0,910.0,920.0],"reward/total":[0.269583,-0.042344,0.061345,0.457375,0.568871,0.772933,0.794625,0.828958,1.150341,1.308961,1.288988,1.124146,1.716448,1.982256,1.235885,1.454254,1.148508,1.390923,1.675656,1.479025,1.596368,1.585706,1.573519,1.387214,1.433468,1.388964,1.355335,1.308126,1.851636,1.480388,1.279651,1.632317,1.637979,1.811968,1.501455,1.604173,1.998931,1.523932,0.884473,1.362433,0.968041,1.276142,1.425873,1.578095,1.353813,0.821626,0.423435,-0.540458,-0.65699,-0.072638,0.408888,0.124781,-0.640115,-0.500364,0.58995,0.665581,-0.035333,-0.430275,0.77724,0.381959,1.520702,0.284323,1.958901,1.441915,1.117192,1.153308,0.923421,1.185939,1.073975,1.660553,2.037515,1.446354,1.619231,0.86976,1.978804,1.076253,1.705374,1.294658,1.499596,1.076955,1.187448,0.651979,1.283563,1.425236,1.408858,1.470781,0.968135,1.868272,1.094234,1.461998,1.361781,1.557329],"reward/consistency":[-0.008333,-0.141667,-0.079583,0.047917,0.05,0.227462,0.210417,0.152083,0.3125,0.37128,0.3875,0.227083,0.455208,0.536042,0.198958,0.346458,0.207232,0.387827,0.416944,0.332778,0.391448,0.399742,0.380625,0.291117,0.319345,0.333867,0.255263,0.22249,0.479018,0.311095,0.277865,0.367292,0.319167,0.444072,0.382494,0.409385,0.51166,0.383864,0.275854,0.37722,0.28245,0.372802,0.371635,0.468998,0.372647,0.206726,0.104167,-0.027083,0.02,0.124167,0.239583,0.191667,0.109167,0.133507,0.309271,0.260804,0.1928,0.188259,0.396225,0.24131,0.538646,0.364648,0.664709,0.489732,0.434226,0.446875,0.266667,0.446429,0.433185,0.6025,0.721101,0.494167,0.534375,0.350208,0.656875,0.468958,0.615625,0.489526,0.57189,0.461964,0.431458,0.363542,0.497083,0.488393,0.560417,0.545833,0.404583,0.658929,0.532589,0.52625,0.513139,0.617143],"reward/format":[0.029583,0.040625,0.08447,0.23925,0.214527,0.202708,0.289,0.277708,0.277417,0.478917,0.482738,0.545708,0.625042,0.650298,0.605667,0.598161,0.597191,0.5539,0.602333,0.615015,0.601633,0.529583,0.498363,0.474496,0.57357,0.561695,0.608658,0.591693,0.576203,0.580026,0.554892,0.676362,0.659219,0.694734,0.633024,0.669431,0.698543,0.687681,0.642233,0.663081,0.619211,0.650015,0.65536,0.651996,0.593258,0.535154,0.490737,0.172042,0.150667,0.426848,0.406232,0.269938,-0.300896,-0.140624,0.340387,0.225376,0.036561,-0.298757,0.175628,0.149942,0.501272,0.011185,0.562407,0.460619,0.429804,0.532098,0.480765,0.510827,0.444042,0.57524,0.638416,0.554479,0.595273,0.427833,0.586304,0.468399,0.640384,0.517588,0.610386,0.457446,0.488229,0.348229,0.604312,0.604053,0.492764,0.577312,0.436729,0.655473,0.377913,0.51385,0.561604,0.449583],"reward/answer":[0.95,0.8875,0.7125,0.7375,0.8625,0.7375,0.725,0.96875,0.95625,0.775,0.75,0.7375,0.95625,0.95625,0.84375,0.79375,0.73125,0.66875,0.9,0.8375,0.9125,0.89375,0.95,0.85625,0.79375,0.675,0.83125,0.7875,0.8875,0.83125,0.70625,0.8625,0.95,0.8,0.65,0.725,0.925,0.58125,0.10625,0.43125,0.2375,0.375,0.50625,0.6375,0.54375,0.35625,0.3125,-0.08125,-0.2625,-0.10625,0.05625,0.10625,0.0,-0.05,0.1875,0.5125,0.025,0.04375,0.3875,0.28125,0.525,0.09375,0.6875,0.59375,0.4,0.34375,0.5125,0.40625,0.35625,0.54375,0.625,0.5375,0.6125,0.325,0.7625,0.31875,0.4875,0.4125,0.3625,0.31875,0.45625,0.15625,0.34375,0.4875,0.45625,0.48125,0.325,0.56875,0.26875,0.5125,0.4125,0.54375],"reward/gated_answer":[0.7125,0.59375,0.4875,0.49375,0.675,0.61875,0.59375,0.7625,0.80625,0.65,0.58125,0.59375,0.81875,0.8375,0.64375,0.6375,0.525,0.525,0.75,0.66875,0.74375,0.7375,0.80625,0.71875,0.5875,0.50625,0.56875,0.59375,0.7625,0.64375,0.54375,0.66875,0.71875,0.65625,0.50625,0.55,0.76875,0.41875,-0.00625,0.29375,0.09375,0.29375,0.3875,0.525,0.43125,0.25,0.2,-0.13125,-0.2875,-0.125,-0.00625,0.05625,-0.01875,-0.0875,0.0875,0.3625,-0.03125,0.0,0.34375,0.1875,0.45,0.075,0.65,0.55,0.3625,0.3125,0.45625,0.38125,0.3125,0.5,0.625,0.5,0.5875,0.26875,0.73125,0.26875,0.45625,0.375,0.34375,0.30625,0.425,0.14375,0.3125,0.4625,0.44375,0.45,0.31875,0.54375,0.2625,0.5,0.375,0.525],"reward/length_penalty":[-0.457813,-0.463281,-0.3875,-0.3375,-0.381281,-0.380969,-0.390625,-0.425,-0.379576,-0.359375,-0.3375,-0.324375,-0.372656,-0.26575,-0.277344,-0.246875,-0.258594,-0.230969,-0.246719,-0.263281,-0.273062,-0.235469,-0.257031,-0.200937,-0.16375,-0.127031,-0.15317,-0.160031,-0.154656,-0.156281,-0.182732,-0.197179,-0.155865,-0.115812,-0.14133,-0.149835,-0.138094,-0.097045,-0.127261,-0.100854,-0.120085,-0.143585,-0.123743,-0.229968,-0.18375,-0.243659,-0.39973,-0.521562,-0.548438,-0.545469,-0.321094,-0.467969,-0.474219,-0.450937,-0.246219,-0.260937,-0.287844,-0.382344,-0.251563,-0.267219,-0.142438,-0.2845,-0.136219,-0.216656,-0.241638,-0.302344,-0.355469,-0.305469,-0.250906,-0.206281,-0.192219,-0.242219,-0.259406,-0.294531,-0.184406,-0.300781,-0.209687,-0.242563,-0.196125,-0.309156,-0.29175,-0.315625,-0.304813,-0.271094,-0.277344,-0.280469,-0.319531,-0.197656,-0.252562,-0.229188,-0.248875,-0.222656],"kl":[2.885627,1385.577536,0.716998,0.79126,1.60977,0.518647,0.454968,0.475977,0.433965,0.506928,0.414139,0.462008,0.491313,0.428776,0.410218,0.344346,0.375299,0.339105,0.345776,0.39,0.369319,0.357347,0.303665,0.267604,0.305182,0.262768,0.276583,0.256597,0.248114,0.261634,0.256482,0.266954,0.25066,0.290987,0.241875,0.238333,0.306012,0.302309,0.245781,0.227592,0.210829,0.221164,0.224348,0.24051,0.241674,0.269975,0.422739,1.816218,2.310646,4.124291,5.220521,6.380576,15.940051,21.28961,19.680527,19.561682,25.284399,30.439815,15.352287,31.974486,11.926341,51.640777,4.931855,19.380755,27.709954,17.297845,14.127478,15.707446,19.307759,16.913586,11.541168,22.78744,16.408563,31.159153,9.652624,24.804248,16.13262,26.069406,17.852974,29.787204,20.299526,36.520765,15.254641,23.291974,22.483942,26.586944,33.874374,8.1957,33.499064,22.501829,20.37153,21.781652],"loss":[0.0577,27.7116,0.0143,0.0158,0.0322,0.0104,0.0091,0.0095,0.0087,0.0101,0.0083,0.0092,0.0098,0.0086,0.0082,0.0069,0.0075,0.0068,0.0069,0.0078,0.0074,0.0071,0.0061,0.0054,0.0061,0.0053,0.0055,0.0051,0.005,0.0052,0.0051,0.0053,0.005,0.0058,0.0048,0.0048,0.0061,0.006,0.0049,0.0046,0.0042,0.0044,0.0045,0.0048,0.0048,0.0054,0.0085,0.0363,0.0462,0.0825,0.1044,0.1276,0.3188,0.4258,0.3936,0.3912,0.5057,0.6088,0.307,0.6395,0.2385,1.0328,0.0986,0.3876,0.5542,0.346,0.2825,0.3141,0.3862,0.3383,0.2308,0.4557,0.3282,0.6232,0.1931,0.4961,0.3227,0.5214,0.3571,0.5957,0.406,0.7304,0.3051,0.4658,0.4497,0.5317,0.6775,0.1639,0.67,0.45,0.4074,0.4356],"grad_norm":[0.542969,0.550781,0.671875,0.625,1.25,0.439453,0.416016,0.511719,0.484375,0.5625,0.375,0.449219,0.597656,0.667969,0.503906,0.412109,0.570312,0.953125,0.609375,0.335938,0.326172,0.363281,0.392578,0.287109,0.306641,0.202148,0.455078,0.439453,0.414062,0.365234,0.300781,0.263672,0.261719,0.435547,0.292969,0.472656,0.369141,0.241211,0.330078,0.373047,0.316406,0.275391,0.328125,0.373047,0.355469,0.225586,0.898438,1.351562,0.941406,5.6875,1.960938,4.75,1.476562,1.117188,0.894531,3.046875,1.351562,1.398438,1.539062,3.515625,2.703125,1.554688,0.427734,1.023438,1.5,3.046875,3.40625,2.078125,2.15625,0.265625,1.210938,1.695312,0.523438,2.796875,2.546875,0.455078,0.964844,1.867188,1.695312,3.015625,2.765625,7.9375,1.46875,0.498047,2.140625,2.15625,2.046875,3.8125,7.15625,4.09375,1.71875,2.140625],"learning_rate":[3e-06,7e-06,1e-05,1.3e-05,1.7e-05,2e-05,2.4e-05,2.7e-05,3.1e-05,3.4e-05,3.8e-05,4.1e-05,4.4e-05,4.8e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05],"steps/avg_num_steps":[2.35625,2.51875,2.35,2.74375,2.76875,3.03125,2.80625,2.7625,2.9375,2.9875,2.9875,3.01875,3.43125,3.61875,2.8375,3.21875,2.90625,3.58125,3.35625,2.84375,3.65625,3.95,3.0625,3.75,3.825,4.74375,4.1375,4.75,4.35,4.44375,4.5625,4.225,4.60625,5.15625,5.15,5.25,4.5375,5.3625,6.0375,5.6,6.3,6.21875,6.73125,5.25625,5.7,5.31875,4.325,2.075,1.79375,2.39375,2.9375,2.5375,1.25625,1.9625,3.20625,2.80625,2.525,1.7,3.35625,2.86875,4.2375,3.2125,4.88125,3.44375,3.46875,3.11875,2.75625,3.20625,3.23125,3.5875,4.0125,3.2625,3.8,2.74375,3.86875,3.24375,3.775,4.04375,3.58125,3.28125,2.83125,2.35,3.06875,3.375,3.2625,2.975,2.70625,3.49375,3.39375,3.21875,3.21875,3.43125],"steps/avg_valid_steps":[2.35625,2.51875,2.35,2.74375,2.76875,3.03125,2.80625,2.7625,2.9375,2.9875,2.9875,3.01875,3.43125,3.61875,2.8375,3.21875,2.90625,3.58125,3.35625,2.84375,3.65625,3.95,3.0625,3.75,3.825,4.74375,4.1375,4.75,4.35,4.44375,4.5625,4.225,4.60625,5.15625,5.15,5.25,4.5375,5.3625,6.0375,5.6,6.3,6.21875,6.73125,5.25625,5.7,5.31875,4.325,2.075,1.79375,2.39375,2.9375,2.5375,1.25625,1.9625,3.20625,2.80625,2.525,1.7,3.35625,2.86875,4.2375,3.2125,4.88125,3.44375,3.46875,3.11875,2.75625,3.20625,3.23125,3.5875,4.0125,3.2625,3.8,2.74375,3.86875,3.24375,3.775,4.04375,3.58125,3.28125,2.83125,2.35,3.06875,3.375,3.2625,2.975,2.70625,3.49375,3.39375,3.21875,3.21875,3.43125],"steps/format_compliance":[0.197494,0.210172,0.278309,0.328736,0.423913,0.493035,0.460689,0.520021,0.492202,0.576572,0.600817,0.664496,0.652912,0.60046,0.575447,0.531713,0.552038,0.549237,0.566591,0.564017,0.577216,0.542803,0.571758,0.498898,0.476136,0.455596,0.477002,0.489566,0.500173,0.493037,0.498001,0.536656,0.498092,0.464926,0.497574,0.528928,0.463654,0.453076,0.481966,0.475808,0.498993,0.52103,0.495622,0.570615,0.535098,0.537645,0.652989,0.80565,0.829239,0.755653,0.637463,0.705568,0.740927,0.65985,0.534102,0.507397,0.478363,0.485535,0.484328,0.497931,0.441799,0.510649,0.490551,0.556499,0.57485,0.621501,0.727902,0.658749,0.644564,0.526729,0.563383,0.573638,0.624888,0.667987,0.559705,0.605155,0.583735,0.597111,0.56101,0.642437,0.633806,0.704789,0.648238,0.674528,0.644672,0.650688,0.716261,0.589032,0.593261,0.586404,0.610455,0.574709],"completion_length":[893.09375,896.875,779.325,731.89375,951.34375,1066.7625,875.03125,904.6125,965.93125,1008.71875,978.06875,956.55625,836.125,828.54375,913.80625,895.275,805.30625,1235.40625,1209.7,1239.05625,1198.6125,1402.6,1257.4375,1364.35,1247.55625,1962.3375,1427.44375,1754.86875,1803.25625,1673.38125,1871.7875,1624.51875,1170.94375,1493.6125,1616.4,1662.6,1334.275,1340.48125,1589.9125,1388.85,2227.3375,2010.6125,2044.41875,1785.575,1934.275,2795.24375,2237.7875,1495.0,1634.83125,2259.23125,1309.30625,1758.7875,919.225,1613.90625,955.5375,694.2,700.39375,998.18125,953.84375,986.9875,866.88125,791.1625,866.54375,661.20625,705.7875,904.4875,744.9625,931.39375,802.3375,935.29375,877.6375,807.39375,967.94375,638.4875,824.8625,995.7125,1014.375,1018.83125,928.26875,982.6875,878.04375,883.375,1118.05,862.775,903.975,648.04375,791.39375,729.775,838.68125,840.7625,669.3375,826.65625]},"DeepSeek-14B":{"step":[10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.0,110.0,120.0,130.0,140.0,150.0,160.0,170.0,180.0,190.0,200.0],"reward/total":[-0.326231,-0.58345,-0.282458,-0.028451,-0.297117,-0.628011,-0.482845,-0.269902,-0.451345,-0.706807,-0.703396,-0.945577,-0.179731,0.178207,-0.746379,-0.684982,-0.219238,-0.857908,-0.742172,-0.839086],"reward/consistency":[-0.207917,-0.350179,-0.162361,-0.10875,-0.190625,-0.219401,-0.148452,-0.257917,-0.21255,-0.268075,-0.237917,-0.276071,-0.159577,-0.070972,-0.458328,-0.165694,-0.142879,-0.129167,-0.231369,-0.425622],"reward/format":[-0.066856,-0.033433,-0.059167,0.018111,-0.111242,-0.269159,-0.135417,-0.004589,-0.231333,-0.246631,-0.168083,-0.184595,0.128997,0.290291,0.139363,-0.134711,0.056754,-0.365211,-0.061931,0.06583],"reward/answer":[0.65,0.6,0.575,0.6625,0.6375,0.5375,0.3875,0.675,0.6625,0.5375,0.3875,0.15,0.4125,0.4625,0.3125,0.175,0.4125,0.275,0.1875,0.325],"reward/gated_answer":[0.3,0.2375,0.2375,0.3625,0.325,0.2625,0.1875,0.35,0.375,0.2375,0.125,-0.025,0.1625,0.2125,0.05,0.0,0.2,0.1375,0.0,0.025],"reward/length_penalty":[-0.2475,-0.261,-0.20975,-0.242188,-0.223687,-0.29225,-0.304375,-0.223438,-0.276187,-0.295563,-0.295312,-0.321875,-0.227562,-0.211875,-0.243875,-0.296729,-0.254174,-0.433947,-0.333187,-0.2895],"kl":[1781.829893,5231.309665,411.791524,340.131394,51.594733,1.690543,0.723311,0.500706,0.484391,0.424951,0.456083,1.827624,0.384101,0.496094,0.660977,26.009742,74443.41832,3.78099,1782.299295,0.713759],"loss":[35.6366,104.6262,8.2358,6.8026,1.0319,0.0338,0.0145,0.01,0.0097,0.0085,0.0091,0.0366,0.0077,0.0099,0.0132,0.5202,1488.8686,0.0756,35.646,0.0143],"grad_norm":[1840.0,984.0,144.0,45.75,1.703125,0.570312,0.365234,0.796875,0.636719,0.976562,0.455078,42.0,0.71875,1.148438,1.6875,1680.0,2.625,2.375,6.96875,5.5],"learning_rate":[3e-06,7e-06,1e-05,1.3e-05,1.7e-05,2e-05,2.4e-05,2.7e-05,3.1e-05,3.4e-05,3.8e-05,4.1e-05,4.4e-05,4.8e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05],"steps/avg_num_steps":[2.9625,3.1,3.125,2.7375,3.2125,3.0125,2.75,3.1,2.725,2.45,2.3125,2.5375,3.8875,4.4375,4.25,3.1625,3.375,2.125,2.8375,3.75],"steps/avg_valid_steps":[2.9625,3.1,3.125,2.7375,3.2125,3.0125,2.75,3.1,2.725,2.45,2.3125,2.5375,3.8875,4.4375,4.25,3.1625,3.375,2.125,2.8375,3.75],"steps/format_compliance":[0.448259,0.424246,0.41185,0.47368,0.405539,0.415167,0.488641,0.442438,0.417508,0.41284,0.396222,0.480711,0.462345,0.510134,0.453365,0.456212,0.494471,0.411556,0.582046,0.48644],"completion_length":[1549.325,1382.575,1269.6,1036.7125,1352.4375,1726.0,1449.9875,1238.7875,1564.55,1476.225,1625.425,1606.35,1506.2,1325.7625,1658.15,1791.2875,1540.8125,2413.375,2020.6375,1916.9125]},"Qwen3-8B":{"step":[10.0,40.0,70.0,100.0,130.0,160.0,190.0,220.0,250.0,280.0,310.0,340.0,370.0,400.0,430.0,460.0,490.0,520.0,550.0,580.0,610.0,640.0,670.0,700.0,730.0,760.0,790.0,820.0,850.0,880.0,910.0,940.0,970.0,1000.0,1030.0,1060.0,1090.0,1120.0,1150.0,1180.0,1210.0,1240.0,1270.0,1300.0,1330.0,1360.0,1390.0,1420.0,1450.0,1480.0,1510.0,1540.0,1570.0,1600.0,1630.0,1660.0,1690.0,1720.0,1750.0,1780.0,1810.0,1840.0,1870.0,1900.0,1930.0,1960.0,1990.0,2020.0,2050.0,2080.0,2110.0,2140.0,2170.0,2200.0,2230.0,2260.0,2290.0,2320.0,2350.0,2380.0,2410.0,2440.0,2470.0,2500.0,2530.0,2560.0,2590.0,2620.0,2650.0,2660.0],"reward/total":[0.996135,1.222254,0.79522,0.867508,1.178103,1.213318,1.588668,1.545283,1.412995,1.237344,1.453943,1.509302,1.602268,1.258987,1.688078,1.289992,1.612403,1.175662,1.19346,1.431756,1.180765,1.581135,1.369733,1.280673,1.389442,1.457364,1.650769,1.549526,1.719803,1.384323,1.457331,2.099569,1.619297,1.528294,1.782296,1.763367,1.930427,1.778765,2.15472,1.758093,1.838855,1.60327,1.806421,1.950852,1.992155,1.508173,1.830086,1.863517,1.58787,1.92038,1.701807,2.186043,2.116406,2.132458,2.096112,1.535199,1.933426,1.891429,1.489885,1.479264,1.828854,2.181224,1.830218,2.15497,1.859473,2.047459,1.508391,2.120052,2.05974,2.288208,1.767847,2.03776,1.921186,2.117054,2.165605,2.063129,2.300586,2.188387,2.157969,2.310682,2.064241,2.20279,2.212903,2.165712,2.156866,2.015737,2.067738,1.863346,2.060432,2.101677],"reward/consistency":[0.208125,0.441399,0.189062,0.220521,0.340625,0.210417,0.3725,0.344405,0.302917,0.250417,0.29875,0.372292,0.357813,0.203274,0.413512,0.156806,0.330655,0.156905,0.248542,0.239583,0.144196,0.375208,0.195208,0.189583,0.2375,0.352708,0.358745,0.395729,0.463466,0.296667,0.27375,0.632601,0.45,0.318036,0.458321,0.419887,0.506491,0.473125,0.617847,0.416131,0.485089,0.337292,0.475863,0.488125,0.514762,0.314435,0.435208,0.513194,0.426184,0.543437,0.39755,0.587812,0.651875,0.580804,0.627917,0.415461,0.494583,0.45625,0.329762,0.355625,0.470015,0.638958,0.478576,0.626042,0.499583,0.594663,0.265045,0.601042,0.610208,0.644722,0.504167,0.579375,0.457917,0.627188,0.589063,0.562381,0.638333,0.637917,0.645417,0.638542,0.520208,0.665,0.645923,0.534583,0.587798,0.535982,0.588274,0.524653,0.578423,0.577708],"reward/format":[0.451916,0.432969,0.450439,0.44382,0.44375,0.586912,0.626637,0.618988,0.601745,0.589844,0.581704,0.601927,0.682924,0.687701,0.745592,0.725868,0.716629,0.722149,0.665201,0.713735,0.717497,0.683322,0.728108,0.677913,0.724348,0.737285,0.67638,0.573932,0.716354,0.658229,0.686081,0.64548,0.636641,0.715919,0.755315,0.742319,0.791222,0.770952,0.76774,0.76278,0.741586,0.736134,0.736949,0.862393,0.853495,0.797772,0.838128,0.803772,0.780219,0.788193,0.793764,0.884033,0.914844,0.920315,0.841321,0.887872,0.877176,0.816391,0.7492,0.810635,0.780633,0.847005,0.778322,0.820826,0.809411,0.849267,0.768824,0.774115,0.78224,0.859844,0.798576,0.869635,0.868207,0.829866,0.807533,0.843932,0.864993,0.829033,0.798333,0.86162,0.848482,0.800144,0.866354,0.892222,0.895956,0.84442,0.789807,0.80295,0.821525,0.870427],"reward/answer":[0.78125,0.5875,0.5,0.5875,0.71875,0.84375,0.91875,0.95,0.84375,0.8,0.9625,0.875,0.9375,0.84375,0.85625,0.95,0.9625,0.85,0.725,0.98125,0.8375,0.8625,0.96875,0.88125,0.93125,0.76875,0.95625,0.8625,0.84375,0.8625,0.95,0.975,0.71875,0.8,0.74375,0.8,0.75625,0.75625,0.9125,0.8125,0.7625,0.83125,0.825,0.88125,0.85,0.76875,0.84375,0.7125,0.60625,0.75625,0.8625,0.95625,0.70625,0.85,0.79375,0.5,0.925,0.925,0.73125,0.60625,0.8375,0.8625,0.825,0.8,0.75625,0.81875,0.875,0.925,0.875,0.96875,0.69375,0.81875,0.8625,0.86875,0.975,0.9,0.98125,0.86875,0.88125,0.96875,0.975,0.8625,0.88125,0.9875,0.88125,0.85,0.91875,0.7625,0.86875,0.875],"reward/gated_answer":[0.6125,0.4375,0.3625,0.40625,0.58125,0.5875,0.71875,0.71875,0.575,0.6125,0.75,0.65625,0.73125,0.55625,0.65625,0.6625,0.7625,0.5625,0.44375,0.68125,0.55,0.68125,0.6875,0.64375,0.66875,0.56875,0.78125,0.69375,0.73125,0.64375,0.7375,0.85625,0.59375,0.60625,0.5875,0.6625,0.6625,0.65625,0.81875,0.69375,0.65625,0.65,0.675,0.7625,0.73125,0.575,0.71875,0.6375,0.475,0.6625,0.68125,0.90625,0.625,0.7625,0.725,0.3625,0.73125,0.76875,0.56875,0.4625,0.65625,0.75625,0.7,0.71875,0.6,0.7125,0.6625,0.84375,0.7625,0.88125,0.58125,0.7375,0.74375,0.7875,0.8875,0.78125,0.91875,0.78125,0.78125,0.925,0.84375,0.825,0.79375,0.925,0.74375,0.71875,0.80625,0.60625,0.775,0.75625],"reward/length_penalty":[-0.362656,-0.290625,-0.295375,-0.303969,-0.345022,-0.243906,-0.271094,-0.260937,-0.179688,-0.294687,-0.284635,-0.250437,-0.281438,-0.238313,-0.252625,-0.276219,-0.297187,-0.289344,-0.252366,-0.245729,-0.232223,-0.28625,-0.277438,-0.252344,-0.290844,-0.315234,-0.281854,-0.258625,-0.361437,-0.317969,-0.31875,-0.295437,-0.221094,-0.198116,-0.159875,-0.183888,-0.163076,-0.275312,-0.258125,-0.247812,-0.201563,-0.204844,-0.251198,-0.292479,-0.243638,-0.279687,-0.271792,-0.23075,-0.232094,-0.240781,-0.267344,-0.379031,-0.282813,-0.285969,-0.295521,-0.254094,-0.281562,-0.25843,-0.241875,-0.23585,-0.211385,-0.242969,-0.262792,-0.199272,-0.184938,-0.268594,-0.240813,-0.285312,-0.274531,-0.258021,-0.264323,-0.265,-0.250073,-0.317656,-0.26771,-0.289479,-0.284406,-0.242312,-0.272031,-0.284969,-0.278616,-0.294854,-0.25671,-0.317448,-0.179993,-0.210312,-0.295573,-0.206166,-0.232969,-0.232187],"kl":[0.421575,0.441705,0.412614,0.414001,0.404774,0.477377,0.432892,0.393061,0.429032,0.384321,0.391255,0.389387,0.392362,0.405695,0.378968,0.393448,0.379054,0.392362,0.399933,0.402376,0.395453,0.434758,0.385833,0.399887,0.410943,0.418067,0.385362,0.413169,0.417575,0.388003,0.427741,0.382697,0.417213,0.418191,0.403074,0.383259,0.380386,0.42486,0.388989,0.39236,0.414965,0.407147,0.51149,0.425087,0.430461,0.459372,0.378773,0.408497,0.470975,0.411808,0.429606,0.479602,0.4741,0.451273,0.462774,0.479043,0.477623,0.49236,0.494295,0.502235,0.492129,0.484778,0.466523,0.561052,0.480467,0.42824,0.465131,0.484773,0.572114,0.426774,0.455714,0.418023,0.432589,0.436335,0.450836,0.4827,0.429347,0.474291,0.423727,0.475893,0.443154,0.42098,0.534659,0.499863,0.449666,0.436241,0.412093,0.402508,0.432039,0.462893],"loss":[0.0084,0.0088,0.0083,0.0083,0.0081,0.0095,0.0087,0.0079,0.0086,0.0077,0.0078,0.0078,0.0078,0.0081,0.0076,0.0079,0.0076,0.0078,0.008,0.008,0.0079,0.0087,0.0077,0.008,0.0082,0.0084,0.0077,0.0083,0.0084,0.0078,0.0086,0.0077,0.0083,0.0084,0.0081,0.0077,0.0076,0.0085,0.0078,0.0078,0.0083,0.0081,0.0102,0.0085,0.0086,0.0092,0.0076,0.0082,0.0094,0.0082,0.0086,0.0096,0.0095,0.009,0.0093,0.0096,0.0096,0.0098,0.0099,0.01,0.0098,0.0097,0.0093,0.0112,0.0096,0.0086,0.0093,0.0097,0.0114,0.0085,0.0091,0.0084,0.0087,0.0087,0.009,0.0097,0.0086,0.0095,0.0085,0.0095,0.0089,0.0084,0.0107,0.01,0.009,0.0087,0.0082,0.0081,0.0086,0.0093],"grad_norm":[0.359375,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.287109,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN],"learning_rate":[3e-06,1.3e-05,2.4e-05,3.4e-05,4.4e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,5e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.9e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.8e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.7e-05,4.6e-05,4.6e-05,4.6e-05,4.5e-05,4.5e-05,4.5e-05,4.4e-05,4.4e-05,4.4e-05,4.4e-05,4.3e-05,4.3e-05,4.2e-05,4.2e-05,4.2e-05,4.1e-05,4.1e-05,4.1e-05,4e-05,4e-05,3.9e-05,3.9e-05,3.9e-05,3.8e-05,3.8e-05,3.7e-05,3.7e-05,3.6e-05,3.6e-05,3.5e-05,3.5e-05,3.4e-05,3.4e-05,3.4e-05,3.3e-05,3.3e-05,3.2e-05,3.2e-05,3.1e-05,3.1e-05,3e-05,3e-05,2.9e-05,2.9e-05,2.8e-05,2.8e-05,2.7e-05,2.7e-05,2.6e-05,2.6e-05,2.5e-05,2.5e-05,2.4e-05,2.4e-05,2.3e-05,2.3e-05,2.2e-05,2.2e-05],"steps/avg_num_steps":[3.2625,3.225,3.43125,3.35,3.65625,3.5625,3.43125,4.08125,3.525,3.64375,3.4375,3.875,3.45625,3.38125,4.21875,4.3125,3.58125,3.8,3.6875,3.80625,3.7875,3.575,3.96875,3.58125,3.9625,3.7125,3.6125,3.35,3.7375,3.29375,3.1,4.4125,3.8875,4.39375,4.3625,4.725,4.81875,4.025,4.29375,4.1125,3.81875,3.90625,3.8,4.375,4.23125,3.88125,4.7,4.275,4.4625,4.7125,4.225,3.6375,3.975,4.36875,4.16875,4.2125,3.9625,3.725,4.05,3.95625,4.55625,4.35625,4.425,4.51875,4.325,4.3,3.4375,3.5625,3.55,4.325,3.63125,4.24375,3.95625,3.85,3.5375,3.8,3.79375,3.50625,3.78125,3.625,4.05625,3.78125,4.2375,3.125,4.2125,3.96875,4.41875,4.6875,3.8125,3.95],"steps/avg_valid_steps":[3.2625,3.225,3.43125,3.35,3.65625,3.5625,3.43125,4.08125,3.525,3.64375,3.4375,3.875,3.45625,3.38125,4.21875,4.3125,3.58125,3.8,3.6875,3.80625,3.7875,3.575,3.96875,3.58125,3.9625,3.7125,3.6125,3.35,3.7375,3.29375,3.1,4.4125,3.8875,4.39375,4.3625,4.725,4.81875,4.025,4.29375,4.1125,3.81875,3.90625,3.8,4.375,4.23125,3.88125,4.7,4.275,4.4625,4.7125,4.225,3.6375,3.975,4.36875,4.16875,4.2125,3.9625,3.725,4.05,3.95625,4.55625,4.35625,4.425,4.51875,4.325,4.3,3.4375,3.5625,3.55,4.325,3.63125,4.24375,3.95625,3.85,3.5375,3.8,3.79375,3.50625,3.78125,3.625,4.05625,3.78125,4.2375,3.125,4.2125,3.96875,4.41875,4.6875,3.8125,3.95],"steps/format_compliance":[0.643098,0.613996,0.608505,0.634058,0.654801,0.570395,0.597754,0.630134,0.544715,0.626057,0.631332,0.615639,0.632357,0.587245,0.600789,0.604412,0.6162,0.610699,0.574154,0.575509,0.579314,0.628255,0.609751,0.596855,0.607237,0.639301,0.621033,0.599715,0.662601,0.634072,0.664293,0.618391,0.598862,0.577768,0.526009,0.546276,0.554598,0.630394,0.605986,0.596846,0.593538,0.568351,0.597192,0.651526,0.622902,0.628413,0.620192,0.610857,0.587445,0.607383,0.616811,0.696952,0.650528,0.661392,0.650099,0.638185,0.628244,0.624844,0.597881,0.6216,0.5813,0.609936,0.588321,0.571525,0.569747,0.622963,0.591481,0.611661,0.627072,0.606515,0.64887,0.638834,0.642667,0.654425,0.611455,0.648967,0.63162,0.591148,0.634291,0.641812,0.620403,0.639386,0.616007,0.704365,0.558996,0.599405,0.624789,0.561656,0.60119,0.61607],"completion_length":[894.7875,742.0875,885.93125,848.25,896.48125,891.89375,839.48125,808.5625,732.41875,783.01875,853.7,795.70625,723.10625,686.9125,806.4875,930.66875,663.85625,777.89375,615.56875,730.66875,799.59375,629.88125,690.9,756.8,875.9,697.0375,794.9875,755.475,829.43125,853.45,673.98125,860.45,673.35,827.63125,741.2625,1021.21875,967.85,891.9375,838.35,957.14375,711.99375,844.1875,663.23125,846.20625,803.74375,792.64375,937.64375,809.5,720.8875,803.99375,737.49375,654.55,753.58125,739.725,687.675,681.08125,545.4,666.31875,664.24375,733.175,818.46875,887.8375,867.3625,853.7625,813.50625,893.75625,887.55,676.18125,742.86875,1196.925,864.3625,954.04375,906.25625,967.63125,1015.74375,967.98125,911.00625,909.9875,864.43125,852.48125,1341.875,1102.63125,1039.825,770.34375,978.475,948.39375,1162.04375,1224.5625,1093.91875,937.59375]},"QwQ-32B":{"step":[10.0,20.0,30.0,40.0,50.0,60.0,70.0,80.0,90.0,100.0,110.0,120.0,130.0,140.0,150.0],"reward/total":[-0.982812,-0.738802,-0.741562,-0.538283,-0.474702,-0.702903,-0.3695,-0.363314,-0.215626,0.198028,0.427974,0.543596,0.418416,0.429413,0.485421],"reward/consistency":[-0.1,-0.02875,-0.014167,-0.048958,-0.206806,-0.307386,-0.29119,-0.345584,-0.38247,-0.201012,-0.177083,-0.086786,-0.147566,-0.169226,-0.08625],"reward/format":[-0.834062,-0.895677,-0.920312,-0.755221,-0.327869,-0.159074,0.030536,0.181125,0.384329,0.510859,0.530328,0.494506,0.542354,0.57769,0.516234],"reward/answer":[0.55,0.7125,0.7125,0.8125,0.675,0.275,0.425,0.5125,0.4375,0.6,0.7625,0.75,0.675,0.725,0.775],"reward/gated_answer":[0.5,0.6875,0.6875,0.7125,0.4875,0.1625,0.2375,0.2,0.0875,0.2625,0.425,0.475,0.425,0.4125,0.5],"reward/length_penalty":[-0.49875,-0.4875,-0.4875,-0.419,-0.321,-0.242125,-0.197625,-0.216375,-0.112187,-0.267563,-0.246625,-0.292295,-0.327589,-0.305063,-0.392062],"kl":[3.289519,4.433889,3.548968,4.470772,1.862677,1.079152,0.705807,5.593174,0.119839,0.04656,0.102374,0.041908,0.031885,0.045657,0.033705],"loss":[0.0658,0.0887,0.071,0.0894,0.0373,0.0216,0.0141,0.1119,0.0024,0.0009,0.002,0.0008,0.0006,0.0009,0.0007],"grad_norm":[9.875,0.621094,0.466797,6.03125,2.515625,8.0,3.0,0.117188,0.120605,0.165039,0.287109,0.137695,0.106445,0.082031,0.162109],"learning_rate":[4e-06,8e-06,1.2e-05,1.6e-05,2e-05,2.4e-05,2.8e-05,3e-05,3e-05,3e-05,3e-05,3e-05,3e-05,3e-05,3e-05],"steps/avg_num_steps":[0.675,0.4125,0.325,1.1,3.025,3.8875,4.35,4.4125,6.05,4.4125,4.95,4.7625,4.05,4.0625,4.3375],"steps/avg_valid_steps":[0.675,0.4125,0.325,1.1,3.025,3.8875,4.35,4.4125,6.05,4.4125,4.95,4.7625,4.05,4.0625,4.3375],"steps/format_compliance":[0.527302,0.624074,0.552083,0.44884,0.457131,0.464876,0.458971,0.496858,0.481892,0.62593,0.606512,0.645939,0.689358,0.67902,0.700721],"completion_length":[589.1875,179.475,194.2,133.0125,505.7375,626.3625,562.925,777.6,823.5625,855.45,809.8625,976.65,973.4,845.4625,988.2875]}},"sft":{"DeepSeek-7B":{"step":[10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350,360,370,380,390,400],"loss":[0.6544,0.5825,0.51,0.4825,0.4021,0.4029,0.3695,0.3362,0.2891,0.3239,0.2927,0.3064,0.2899,0.264,0.2844,0.2425,0.2391,0.2481,0.1898,0.269,0.2684,0.2563,0.2391,0.2425,0.2531,0.2496,0.2407,0.2071,0.1834,0.2045,0.1956,0.2339,0.25,0.2306,0.2045,0.2046,0.176,0.226,0.1882,0.2024],"learning_rate":[1.9565217391304346e-05,4.130434782608695e-05,6.304347826086956e-05,8.478260869565217e-05,0.00010652173913043477,0.00012826086956521738,0.00015,0.00014997796567536848,0.00014991187564844624,0.0001498017687525429,0.0001496477096844874,0.00014944978896661362,0.00014920812289357082,0.00014892285346399117,0.00014859414829705383,0.000148222200533995,0.00014780722872462148,0.00014734947669889495,0.00014684921342366167,0.0001463067328446125,0.00014572235371356566,0.00014509641940117413,0.00014442929769516679,0.00014372138058424335,0.00014297308402774875,0.00014218484771126287,0.00014135713478824932,0.00014049043160791467,0.0001395852474294385,0.0001386421141227419,0.00013766158585597023,0.00013664423876987386,0.00013559067063927832,0.00013450150052184262,0.000133377368394312,0.00013221893477647912,0.00013102688034307469,0.00012980190552381506,0.00012854473009184242,0.0001272560927407991],"grad_norm":[0.08545,0.10547,0.11377,0.10645,0.12207,0.14355,0.12109,0.12695,0.1416,0.14355,0.17285,0.15137,0.1582,0.17969,0.16113,0.15723,0.16992,0.17285,0.14648,0.16406,0.15918,0.32227,0.16992,0.17383,0.17871,0.16211,0.1709,0.20801,0.17383,0.17285,0.17285,0.18359,0.19531,0.1875,0.18457,0.20312,0.19434,0.19336,0.19043,0.19434]},"Qwen3-8B":{"step":[10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350,360,370,380,390,400],"loss":[0.716,0.5813,0.4415,0.4345,0.3722,0.3713,0.3413,0.3116,0.2752,0.3014,0.2708,0.2808,0.2671,0.2455,0.2619,0.2238,0.2228,0.2286,0.1815,0.2469,0.2475,0.2352,0.2198,0.2246,0.2308,0.2341,0.2231,0.1987,0.1789,0.1937,0.1862,0.2183,0.237,0.2168,0.1964,0.1935,0.1695,0.2145,0.1808,0.1918],"learning_rate":[1.9565217391304346e-05,4.130434782608695e-05,6.304347826086956e-05,8.478260869565217e-05,0.00010652173913043477,0.00012826086956521738,0.00015,0.00014997796567536848,0.00014991187564844624,0.0001498017687525429,0.0001496477096844874,0.00014944978896661362,0.00014920812289357082,0.00014892285346399117,0.00014859414829705383,0.000148222200533995,0.00014780722872462148,0.00014734947669889495,0.00014684921342366167,0.0001463067328446125,0.00014572235371356566,0.00014509641940117413,0.00014442929769516679,0.00014372138058424335,0.00014297308402774875,0.00014218484771126287,0.00014135713478824932,0.00014049043160791467,0.0001395852474294385,0.0001386421141227419,0.00013766158585597023,0.00013664423876987386,0.00013559067063927832,0.00013450150052184262,0.000133377368394312,0.00013221893477647912,0.00013102688034307469,0.00012980190552381506,0.00012854473009184242,0.0001272560927407991],"grad_norm":[0.66797,0.22266,0.12988,0.10693,0.1123,0.12793,0.11865,0.12402,0.125,0.13379,0.15234,0.14648,0.14648,0.16797,0.14648,0.13574,0.14844,0.15527,0.13867,0.14746,0.14941,0.16016,0.15234,0.15625,0.16211,0.15137,0.1543,0.17676,0.15332,0.16699,0.15234,0.16797,0.16797,0.16797,0.15332,0.19043,0.17773,0.17383,0.16406,0.16992]},"DeepSeek-14B":{"step":[10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200],"loss":[0.616,0.5526,0.4763,0.4482,0.3649,0.3645,0.3326,0.3053,0.2646,0.2917,0.2633,0.2726,0.2624,0.2399,0.2548,0.218,0.2178,0.2231,0.1774,0.2405],"learning_rate":[1.3043478260869566e-05,2.753623188405797e-05,4.202898550724638e-05,5.652173913043478e-05,7.101449275362319e-05,8.55072463768116e-05,0.0001,9.998531045024566e-05,9.994125043229752e-05,9.986784583502862e-05,9.976513978965829e-05,9.96331926444091e-05,9.947208192904722e-05,9.928190230932746e-05,9.906276553136923e-05,9.881480035599667e-05,9.853815248308101e-05,9.823298446592998e-05,9.789947561577445e-05,9.753782189640834e-05],"grad_norm":[0.12891,0.16992,0.11719,0.09326,0.09961,0.13867,0.10889,0.11035,0.13379,0.13965,0.14551,0.14453,0.15723,0.17871,0.1543,0.15039,0.16211,0.18262,0.15137,0.15625]}}};

// === CHART CONFIG ===
Chart.defaults.color = '#94a3b8';
Chart.defaults.borderColor = '#1e293b';
Chart.defaults.font.family = "'Segoe UI', system-ui, sans-serif";

const zoomPlugin = {
    zoom: { wheel: { enabled: true }, pinch: { enabled: true }, mode: 'x' },
    pan: { enabled: true, mode: 'x' },
};

const COLORS = {
    'DeepSeek-7B':  { line: '#60a5fa', fill: 'rgba(96,165,250,0.08)' },
    'DeepSeek-14B': { line: '#f472b6', fill: 'rgba(244,114,182,0.08)' },
    'Qwen3-8B':    { line: '#a78bfa', fill: 'rgba(167,139,250,0.08)' },
    'QwQ-32B':     { line: '#34d399', fill: 'rgba(52,211,153,0.08)' },
};
const COMP_COLORS = {
    'reward/consistency':    { line: '#60a5fa', fill: 'rgba(96,165,250,0.10)' },
    'reward/gated_answer':   { line: '#34d399', fill: 'rgba(52,211,153,0.10)' },
    'reward/format':         { line: '#fbbf24', fill: 'rgba(251,191,36,0.10)' },
    'reward/length_penalty': { line: '#f87171', fill: 'rgba(248,113,113,0.10)' },
};
const QUAL_COLORS = {
    'steps/format_compliance': { line: '#fbbf24', fill: 'rgba(251,191,36,0.10)' },
    'steps/avg_valid_steps':   { line: '#60a5fa', fill: 'rgba(96,165,250,0.10)' },
    'steps/avg_num_steps':     { line: '#a78bfa', fill: 'rgba(167,139,250,0.10)' },
    'completion_length':        { line: '#34d399', fill: 'rgba(52,211,153,0.10)' },
};

function makeDS(label, steps, values, lineColor, fillColor) {
    return {
        label: label,
        data: steps.map(function(x, i) { return { x: x, y: values[i] }; }),
        borderColor: lineColor,
        backgroundColor: fillColor || 'transparent',
        fill: !!fillColor,
        borderWidth: 2,
        pointRadius: 0,
        pointHoverRadius: 4,
        pointHoverBackgroundColor: lineColor,
        tension: 0.35,
    };
}

function gc() { return 'rgba(51,65,85,0.5)'; }

function opts(yLabel) {
    return {
        responsive: true, maintainAspectRatio: false,
        interaction: { mode: 'nearest', intersect: false },
        scales: {
            x: { type: 'linear', title: { display: true, text: 'Training Step', color: '#64748b', font: { size: 11 } }, grid: { color: gc() }, ticks: { color: '#64748b', font: { size: 10 } } },
            y: { title: { display: true, text: yLabel, color: '#64748b', font: { size: 11 } }, grid: { color: gc() }, ticks: { color: '#64748b', font: { size: 10 } } },
        },
        plugins: {
            legend: { position: 'top', labels: { boxWidth: 16, padding: 14, color: '#cbd5e1', font: { size: 11 } } },
            zoom: zoomPlugin,
            tooltip: { backgroundColor: '#1e293b', titleColor: '#f1f5f9', bodyColor: '#cbd5e1', borderColor: '#334155', borderWidth: 1, padding: 10, displayColors: true,
                callbacks: { label: function(ctx) { return ctx.dataset.label + ': ' + ctx.parsed.y.toFixed(4); } } },
        },
    };
}

function miniOpts(yLabel) {
    var o = opts(yLabel);
    o.plugins.legend = { display: false };
    o.scales.x.title.font = { size: 10 };
    o.scales.y.title.font = { size: 10 };
    return o;
}

// 1. SFT
var sftDS = [];
for (var name in D.sft) {
    var d = D.sft[name], c = COLORS[name];
    sftDS.push(makeDS(name, d.step, d.loss, c.line, c.fill));
}
new Chart(document.getElementById('sftChart'), { type: 'line', data: { datasets: sftDS }, options: opts('Loss') });

// 2a. Total Reward
var trDS = [];
for (var name in D.grpo) {
    var d = D.grpo[name], c = COLORS[name];
    trDS.push(makeDS(name, d.step, d['reward/total'], c.line, c.fill));
}
new Chart(document.getElementById('totalRewardChart'), { type: 'line', data: { datasets: trDS }, options: opts('Total Reward') });

// 2b. Components
var compMetrics = { compConsistencyChart: 'reward/consistency', compAnswerChart: 'reward/gated_answer', compFormatChart: 'reward/format', compLengthChart: 'reward/length_penalty' };
var compLabels = { 'reward/consistency': 'Consistency', 'reward/gated_answer': 'Answer (Gated)', 'reward/format': 'Format', 'reward/length_penalty': 'Length Penalty' };
var compCharts = {};
function createComponentCharts(runName) {
    var d = D.grpo[runName]; if (!d) return;
    for (var canvasId in compMetrics) {
        var metric = compMetrics[canvasId];
        if (compCharts[canvasId]) compCharts[canvasId].destroy();
        var cc = COMP_COLORS[metric];
        compCharts[canvasId] = new Chart(document.getElementById(canvasId), {
            type: 'line',
            data: { datasets: [makeDS(compLabels[metric], d.step, d[metric], cc.line, cc.fill)] },
            options: miniOpts(compLabels[metric]),
        });
    }
}
function switchComponents(btn) {
    btn.parentElement.querySelectorAll('.model-btn').forEach(function(b) { b.classList.remove('active'); });
    btn.classList.add('active');
    createComponentCharts(btn.dataset.run);
}
createComponentCharts('Qwen3-8B');

// 2c. KL
var klDS = [];
for (var name in D.grpo) {
    var d = D.grpo[name], c = COLORS[name];
    var klCapped = d.kl.map(function(v) { return v === null ? null : Math.min(v, 100); });
    klDS.push(makeDS(name, d.step, klCapped, c.line, null));
}
new Chart(document.getElementById('klChart'), { type: 'line', data: { datasets: klDS }, options: opts('KL Divergence (capped at 100)') });

// 3. Quality
var qualMetrics = {
    qualFormatChart: { key: 'steps/format_compliance', label: 'Format Compliance' },
    qualValidChart: { key: 'steps/avg_valid_steps', label: 'Avg Valid Steps' },
    qualNumStepsChart: { key: 'steps/avg_num_steps', label: 'Avg Num Steps' },
    qualLengthChart: { key: 'completion_length', label: 'Tokens' },
};
var qualCharts = {};
function createQualityCharts(runName) {
    var d = D.grpo[runName]; if (!d) return;
    for (var canvasId in qualMetrics) {
        var cfg = qualMetrics[canvasId];
        if (qualCharts[canvasId]) qualCharts[canvasId].destroy();
        var cc = QUAL_COLORS[cfg.key];
        qualCharts[canvasId] = new Chart(document.getElementById(canvasId), {
            type: 'line',
            data: { datasets: [makeDS(cfg.label, d.step, d[cfg.key], cc.line, cc.fill)] },
            options: miniOpts(cfg.label),
        });
    }
}
function switchQuality(btn) {
    btn.parentElement.querySelectorAll('.model-btn').forEach(function(b) { b.classList.remove('active'); });
    btn.classList.add('active');
    createQualityCharts(btn.dataset.run);
}
createQualityCharts('Qwen3-8B');
</script>
</body>
</html>